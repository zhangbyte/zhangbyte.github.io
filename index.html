<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Zbyte's Blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Zbyte's Blog</h1><a id="logo" href="/.">Zbyte's Blog</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title"><a href="/2017/04/08/mysql使用中遇到的一些问题记录/">mysql使用中遇到的一些问题记录</a></h1><div class="post-meta">2017-04-08</div><div class="post-content"><p>使用mysql进行开发遇到过各种各样的问题,在此记录下方便以后查询.</p>
<h2 id="数据库连接超时问题"><a href="#数据库连接超时问题" class="headerlink" title="数据库连接超时问题"></a>数据库连接超时问题</h2><p>近期开发的一个项目,早上学弟使用频频出现500错误,但是刷新后又正常.去服务器看了下tomcat的日志,发现了一个问题.<br>日志目录: <code>tomcat/logs/localhost.2017-03-16.log</code><br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="number">16</span>-Mar<span class="number">-2017</span> <span class="number">10</span>:<span class="number">02</span>:<span class="number">08.180</span> SEVERE [<span class="keyword">http</span>-nio<span class="number">-8082</span>-exec<span class="number">-206</span>] org.apache.catalina.core.StandardWrapperValve.invoke Servlet.service() <span class="keyword">for</span> servlet [fireant-dispatcher] <span class="keyword">in</span> context <span class="keyword">with</span> path [] threw exception [Request processing failed; nested exception is org.springframework.dao.RecoverableDataAccessException: </div><div class="line"><span class="comment">### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: The last packet successfully received from the server was78793 seconds ago.The last packet sent successfully to the server was 78793 seconds ago, which  is longer than the server configured value of 'wait_timeout'. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property 'autoReconnect=true' to avoid this problem.</span></div><div class="line"><span class="comment">### The error may exist in file [/opt/www/fireant/ROOT/WEB-INF/classes/mapper/UserDao.xml]</span></div><div class="line"><span class="comment">### The error may involve org.duohuo.fireant.dao.UserDao.queryById-Inline</span></div><div class="line"><span class="comment">### The error occurred while setting parameters</span></div><div class="line"><span class="comment">### SQL: select user_id, id, name, state, times, study_time, msg   from user   where user_id = ?</span></div><div class="line"><span class="comment">### Cause: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: The last packet successfully received from the server was78793 seconds ago.The last packet sent successfully to the server was 78793 seconds ago, which  is longer than the server configured value of 'wait_timeout'. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property 'autoReconnect=true' to avoid this problem.</span></div><div class="line">; SQL []; The <span class="keyword">last</span> packet successfully received <span class="built_in">from</span> <span class="keyword">the</span> server was78793 <span class="built_in">seconds</span> ago.The <span class="keyword">last</span> packet sent successfully <span class="built_in">to</span> <span class="keyword">the</span> server was <span class="number">78793</span> <span class="built_in">seconds</span> ago, which  is longer than <span class="keyword">the</span> server configured <span class="built_in">value</span> <span class="keyword">of</span> <span class="string">'wait_timeout'</span>. You should consider either expiring <span class="keyword">and</span>/<span class="keyword">or</span> testing connection validity <span class="keyword">before</span> use <span class="keyword">in</span> your application, increasing <span class="keyword">the</span> server configured values <span class="keyword">for</span> client timeouts, <span class="keyword">or</span> <span class="keyword">using</span> <span class="keyword">the</span> Connector/J connection property <span class="string">'autoReconnect=true'</span> <span class="built_in">to</span> avoid this problem.; nested exception is com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: The <span class="keyword">last</span> packet successfully received <span class="built_in">from</span> <span class="keyword">the</span> server was78793 <span class="built_in">seconds</span> ago.The <span class="keyword">last</span> packet sent successfully <span class="built_in">to</span> <span class="keyword">the</span> server was <span class="number">78793</span> <span class="built_in">seconds</span> ago, which  is longer than <span class="keyword">the</span> server configured <span class="built_in">value</span> <span class="keyword">of</span> <span class="string">'wait_timeout'</span>. You should consider either expiring <span class="keyword">and</span>/<span class="keyword">or</span> testing connection validity <span class="keyword">before</span> use <span class="keyword">in</span> your application, increasing <span class="keyword">the</span> server configured values <span class="keyword">for</span> client timeouts, <span class="keyword">or</span> <span class="keyword">using</span> <span class="keyword">the</span> Connector/J connection property <span class="string">'autoReconnect=true'</span> <span class="built_in">to</span> avoid this problem.] <span class="keyword">with</span> root cause</div><div class="line"> java.net.SocketException: Broken pipe</div><div class="line">	......</div></pre></td></tr></table></figure></p></div><p class="readmore"><a href="/2017/04/08/mysql使用中遇到的一些问题记录/">阅读更多</a></p></div><div class="post"><h1 class="post-title"><a href="/2017/03/27/MAVEN使用笔记/">MAVEN使用笔记</a></h1><div class="post-meta">2017-03-27</div><div class="post-content"><p>之前学习java框架时就有看到过maven，因为当时对各种方面概念的不理解，觉得maven很复杂且没必要，就没有学习使用。之后学习nodejs和python，使用到包管理工具npm和pip，才意识到这种工具的必要性。当然jar包的统一管理只是maven中的一项功能，网上说maven是项目管理工具，在之后的使用中应该会有所体会。</p></div><p class="readmore"><a href="/2017/03/27/MAVEN使用笔记/">阅读更多</a></p></div><div class="post"><h1 class="post-title"><a href="/2017/03/27/hello-world/">Hello World</a></h1><div class="post-meta">2017-03-27</div><div class="post-content"><p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p></div><p class="readmore"><a href="/2017/03/27/hello-world/">阅读更多</a></p></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/database/">database</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/maven/" style="font-size: 15px;">maven</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/04/08/mysql使用中遇到的一些问题记录/">mysql使用中遇到的一些问题记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/27/MAVEN使用笔记/">MAVEN使用笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/27/hello-world/">Hello World</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Zbyte's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>